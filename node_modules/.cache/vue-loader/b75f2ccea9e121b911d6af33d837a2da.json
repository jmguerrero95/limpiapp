{"remainingRequest":"/home/ubuntu/limpiapp/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/limpiapp/src/components/managementuser/editUser.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ubuntu/limpiapp/src/components/managementuser/editUser.vue","mtime":1579963278000},{"path":"/home/ubuntu/limpiapp/node_modules/vuetify-loader/lib/loader.js","mtime":1574476662000},{"path":"/home/ubuntu/limpiapp/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ubuntu/limpiapp/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport overlayalert from '@/components/popups/CompPopsAlert.vue'\r\nimport { mapState,mapMutations } from \"vuex\";\r\nimport axios from 'axios'\r\nexport default {\r\n  components: {\r\n    overlayalert,\r\n  },\r\n  data() {\r\n    return {\r\n      datos: {\r\n        id: \"\",\r\n        firs_name: \"\",\r\n        last_name: \"\",\r\n        user_email: \"\",\r\n        tipo: \"\",\r\n        image: \"\",\r\n        image2: null,\r\n        ident: \"\",\r\n        userPhone: \"\",\r\n        user_Address: \"\",\r\n        birthDay: \"\",\r\n        tipo2:\"\",\r\n        userInternalSkills: [],\r\n      }, \r\n      userInternalSkills: [],\r\n      birthDay:\"\",\r\n      modCheckService:[],\r\n      listNumber: 1,\r\n      menu: false,\r\n      modal: false,\r\n      menu2: false,\r\n      locale: \"es\",\r\n      popout: false,\r\n      inset: false,\r\n      multiple: false,\r\n      disabled: false,\r\n      readonly: false,\r\n      focusable: false,\r\n      persistentHint: true,\r\n      userDataFields: {\r\n        firstNamesLabel: \"Nombres\",\r\n        firstNameHint: \"Edite sus nombres\",\r\n        lastNamesLabel: \"Apellidos\",\r\n        lastNameHint: \"Edite sus apellidos\",\r\n        idLabel: \"Documento de identidad\",\r\n        idHint: \"Edite su id\",\r\n        emailLabel: \"Email\",\r\n        emailHint: \"Edite su email\",\r\n        phoneLabel: \"Teléfono\",\r\n        phoneHint: \"Edite su teléfono\",\r\n        birthDayLabel: \"Fecha de cumpleaños\",\r\n        birthDayHint: \"Edite su cumpleaños\",\r\n        emailRules: [\r\n          v => !!v || \"Correo es requerido\",\r\n          v => /.+@.+/.test(v) || \"Correo no válido\"\r\n        ],\r\n        rulesUpLoadAvatar: [\r\n          value => !value || value.size < 2000000 || \"Máximo 2 MB!\"\r\n        ],\r\n        addressLabel: \"Dirección\",\r\n        addressHint: \"Edite la dirección\",\r\n        rollLabel: \"Su rol es:\",\r\n        rollsHint: \"Cambiar de Rol\",\r\n        rollEdit: [{ text: \"Admin\" }, { text: \"Auxiliar\" }, { text: \"Cliente\" }]\r\n      }\r\n    };\r\n  },\r\n  created: function(){\r\n    if(sessionStorage.getItem('search')){\r\n      var ident = sessionStorage.getItem('search')\r\n      sessionStorage.removeItem('search')\r\n      const path = 'http://3.15.13.45:8000/api/v1.0/users/?ident='+ident\r\n              axios.get(path).then((response)=> {\r\n                response = response.data\r\n                if (response.results[0]==null) {\r\n                  console.log(\"vacio\")\r\n                  this.popup({tipo:7,overlay:true})\r\n                  setTimeout(this.update_component, 2000)\r\n                }\r\n                else{\r\n                response = response.results[0]\r\n                var skill2=response['this_skills']\r\n                for (var skill in skill2){\r\n                  console.log(skill2[skill].skill)\r\n                  if (skill2[skill].skill==\"Cuidado de menores\"){\r\n                    this.userInternalSkills.push(\"Cuidado de menores\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Cuidado de adulto mayor\"){\r\n                    this.userInternalSkills.push(\"Cuidado de adulto mayor\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Atencion a mascotas\"){\r\n                    this.userInternalSkills.push(\"Atencion a mascotas\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Limpieza zonas comunes\"){\r\n                    this.userInternalSkills.push(\"Limpieza zonas comunes\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Diligencias y compras\"){\r\n                    this.userInternalSkills.push(\"Diligencias y compras\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Servicio de cafeteria\"){\r\n                    this.userInternalSkills.push(\"Servicio de cafeteria\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Preparacion de alimentos\"){\r\n                    this.userInternalSkills.push(\"Preparacion de alimentos\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                }\r\n                var mod2=response['this_mod']\r\n                for (var mod in mod2){\r\n                  console.log(mod2[mod].mod)\r\n                  if (mod2[mod].modalidad==\"Hogar\"){\r\n                    this.modCheckService.push(\"Hogar\")\r\n                    console.log(this.modCheckService)\r\n                  }\r\n                  if (mod2[mod].modalidad==\"Pymes\"){\r\n                    this.modCheckService.push(\"Pymes\")\r\n                    console.log(this.modCheckService)\r\n                  }\r\n                }\r\n\r\n\r\n\r\n\r\n\r\n                //response['this_skills'].forEach(guardar);\r\n                //function guardar(element, index, array){\r\n                  \r\n\r\n\r\n                console.log(\"hola\")\r\n                this.datos.id = response['id']\r\n                this.datos.firs_name = response['firs_name']\r\n                this.datos.last_name = response['last_name']\r\n                this.datos.user_email = response['user_email']\r\n                this.datos.image = response['image']\r\n                if (response['tipo']==1) {\r\n                  this.datos.tipo = \"Cliente\"\r\n                  this.datos.tipo2 = 1\r\n                }\r\n                if (response['tipo']==2) {\r\n                  this.datos.tipo = \"Auxiliar\"\r\n                  this.datos.tipo2 = 2\r\n\r\n                }\r\n                if (response['tipo']==3) {\r\n                  this.datos.tipo = \"Administrador\"\r\n                  this.datos.tipo2 = 3\r\n                }\r\n                this.datos.ident = response['ident']\r\n                this.datos.userPhone = response['userPhone']\r\n                this.datos.user_Address = response['user_Address']\r\n                this.birthDay = response['birthDay']\r\n                }\r\n              })\r\n              .catch((error) => {\r\n                this.popup({tipo:4,overlay:true})\r\n                console.log(error)\r\n              })\r\n\r\n    }\r\n    else\r\n      {var id = sessionStorage.getItem('id_edit')\r\n            console.log(id)\r\n            const path = 'http://3.15.13.45:8000/api/v1.0/users/'+id+'/'\r\n              axios.get(path).then((response)=> {\r\n                response = response.data\r\n                var skill2=response['this_skills']\r\n                for (var skill in skill2){\r\n                  console.log(skill2[skill].skill)\r\n                  if (skill2[skill].skill==\"Cuidado de menores\"){\r\n                    this.userInternalSkills.push(\"Cuidado de menores\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Cuidado de adulto mayor\"){\r\n                    this.userInternalSkills.push(\"Cuidado de adulto mayor\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Atencion a mascotas\"){\r\n                    this.userInternalSkills.push(\"Atencion a mascotas\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Limpieza zonas comunes\"){\r\n                    this.userInternalSkills.push(\"Limpieza zonas comunes\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Diligencias y compras\"){\r\n                    this.userInternalSkills.push(\"Diligencias y compras\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Servicio de cafeteria\"){\r\n                    this.userInternalSkills.push(\"Servicio de cafeteria\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Preparacion de alimentos\"){\r\n                    this.userInternalSkills.push(\"Preparacion de alimentos\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                }\r\n\r\n                var mod2=response['this_mod']\r\n                for (var mod in mod2){\r\n                  console.log(mod2[mod].mod)\r\n                  if (mod2[mod].modalidad==\"Hogar\"){\r\n                    this.modCheckService.push(\"Hogar\")\r\n                    console.log(this.modCheckService)\r\n                  }\r\n                  if (mod2[mod].modalidad==\"Pymes\"){\r\n                    this.modCheckService.push(\"Pymes\")\r\n                    console.log(this.modCheckService)\r\n                  }\r\n                }\r\n\r\n\r\n\r\n\r\n                this.datos.id = response['id']\r\n                this.datos.firs_name = response['firs_name']\r\n                this.datos.last_name = response['last_name']\r\n                this.datos.user_email = response['user_email']\r\n                this.datos.image = response['image']\r\n                if (response['tipo']==1) {\r\n                  this.datos.tipo = \"Cliente\"\r\n                  this.datos.tipo2 = 1\r\n                }\r\n                if (response['tipo']==2) {\r\n                  this.datos.tipo = \"Auxiliar\"\r\n                  this.datos.tipo2 = 2\r\n                }\r\n                if (response['tipo']==3) {\r\n                  this.datos.tipo = \"Administrador\"\r\n                  this.datos.tipo2 = 3\r\n                }\r\n                this.datos.ident = response['ident']\r\n                this.datos.userPhone = response['userPhone']\r\n                this.datos.user_Address = response['user_Address']\r\n                this.birthDay = response['birthDay']\r\n              })\r\n              .catch((error) => {\r\n                this.popup({tipo:4,overlay:true})\r\n                console.log(error)\r\n              })}\r\n  },\r\n  methods:{\r\n    update_component(){\r\n      this.UpdateComponent('usermanagement')\r\n    },\r\n    actualizar(skills, mod){\r\n      var id = this.datos.id\r\n      const path = 'http://3.15.13.45:8000/api/v1.0/users/'+id+'/'\r\n      const path2 = 'http://3.15.13.45:8000/api/v1.0/skills/?id_user='+id\r\n      const path3 = 'http://3.15.13.45:8000/api/v1.0/tipo_mod/?id_user='+id\r\n        /*const path2 = 'http://localhost:8000/api/v1.0/auxi/'*/\r\n        if (this.datos.tipo == \"Cliente\") {\r\n          this.datos.tipo2 = 1\r\n        }\r\n        if (this.datos.tipo == \"Auxiliar\") {\r\n          this.datos.tipo2 = 2\r\n        }\r\n        if (this.datos.tipo == \"Admin\") {\r\n          this.datos.tipo2 = 3\r\n        }\r\n        const formData = new FormData();\r\n        formData.append('firs_name',this.datos.firs_name)\r\n        formData.append('last_name',this.datos.last_name)\r\n        formData.append('user_email',this.datos.user_email)\r\n        formData.append('tipo',this.datos.tipo2)\r\n         if (this.datos.image2==null) {\r\n\r\n        }\r\n        else{\r\n          formData.append('image',this.datos.image2)\r\n        }\r\n        if (this.datos.ident==undefined) {\r\n\r\n        }\r\n        else{\r\n          formData.append('ident',this.datos.ident)\r\n        }\r\n        formData.append('userPhone',this.datos.userPhone)\r\n        if (this.birthDay==null || this.birthDay==undefined || this.birthDay=='undefined') {\r\n\r\n        }\r\n        else{\r\n          formData.append('birthDay',this.birthDay)\r\n        }\r\n        formData.append('user_Address',this.datos.user_Address)\r\n        formData.append('tipo',this.datos.tipo2)\r\n        let options = {\r\n          headers: {\r\n            'content-type': 'multipart/form-data'\r\n          }\r\n        }\r\n      axios.delete(path2).then((response)=> {\r\n        axios.delete(path3).then((response)=> {\r\n\r\n      for (var skill in skills){\r\n        const formData = new FormData();\r\n        var id_user = this.datos.id\r\n        formData.append('id_user',id_user)\r\n        formData.append('skill',skills[skill])\r\n        var path = 'http://3.15.13.45:8000/api/v1.0/skills/'\r\n        let options = {\r\n          headers: {\r\n            'content-type': 'multipart/form-data'\r\n          }\r\n        }\r\n        axios.post(path, formData, options).then((response)=> {\r\n        })\r\n        .catch((error) => {\r\n          console.log(error)\r\n        })\r\n      }\r\n\r\n      for (var modalidad in mod){\r\n        const formData = new FormData();\r\n        var id_user = this.datos.id\r\n        formData.append('id_user',id_user)\r\n        formData.append('modalidad',mod[modalidad])\r\n        var path = 'http://3.15.13.45:8000/api/v1.0/tipo_mod/'\r\n        let options = {\r\n          headers: {\r\n            'content-type': 'multipart/form-data'\r\n          }\r\n        }\r\n        axios.post(path, formData, options).then((response)=> {\r\n        })\r\n        .catch((error) => {\r\n          console.log(error)\r\n        })\r\n      }\r\n\r\n      /*skills.forEach(guardar)\r\n      mod.forEach(guardar_mod)\r\n      function guardar(elemento,indice){\r\n        const formData = new FormData();\r\n        var id_user = response.data.id\r\n        formData.append('id_user',id_user)\r\n        formData.append('skill',elemento)\r\n        var path = 'http://3.15.13.45:8000/api/v1.0/skills/'\r\n        let options = {\r\n          headers: {\r\n            'content-type': 'multipart/form-data'\r\n          }\r\n        }\r\n        axios.post(path, formData, options).then((response)=> {\r\n        })\r\n        .catch((error) => {\r\n          console.log(error)\r\n        })\r\n      }\r\n      function guardar_mod(elemento,indice){\r\n        const formData = new FormData();\r\n        var id_user = response.data.id\r\n        formData.append('id_user',id_user)\r\n        formData.append('modalidad',elemento)\r\n        var path = 'http://3.15.13.45:8000/api/v1.0/tipo_mod/'\r\n        let options = {\r\n          headers: {\r\n            'content-type': 'multipart/form-data'\r\n          }\r\n        }\r\n        axios.post(path, formData, options).then((response)=> {\r\n        })\r\n        .catch((error) => {\r\n          console.log(error)\r\n        })\r\n      }*/\r\n\r\n\r\n      })\r\n      .catch((error) => {\r\n        console.log(error)\r\n      })\r\n      })\r\n      .catch((error) => {\r\n        console.log(error)  \r\n      })\r\n      axios.patch(path, formData, options).then((response)=> {\r\n        var info = response.data\r\n        this.datos.image = info['image']\r\n        this.popup({tipo:3,overlay:true})\r\n        setTimeout(this.paso, 2000)\r\n      })\r\n      .catch((error) => {\r\n        this.popup({tipo:4,overlay:true})\r\n        console.log(error)\r\n      })\r\n    },\r\n    paso(){\r\n      this.UpdateComponent('usermanagement')\r\n    },\r\n    ...mapMutations([\"UpdateComponent\",\"popup\"])\r\n  },\r\n  watch: { \r\n      birthDay(val) {\r\n      var fecha=val;\r\n      if (fecha==null) {\r\n\r\n      }else{\r\n\r\n      //console.log(fecha)\r\n          // Si la fecha es correcta, calculamos la edad\r\n          var values=fecha.split(\"-\");\r\n          var dia = values[2];\r\n          var mes = values[1];\r\n          var ano = values[0];\r\n          // cogemos los valores actuales\r\n          var fecha_hoy = new Date();\r\n          var ahora_ano = fecha_hoy.getYear();\r\n          var ahora_mes = fecha_hoy.getMonth()+1;\r\n          var ahora_dia = fecha_hoy.getDate();\r\n   \r\n          // realizamos el calculo\r\n          var edad = (ahora_ano + 1900) - ano;\r\n          if ( ahora_mes < mes )\r\n          {\r\n              edad--;\r\n          }\r\n          if ((mes == ahora_mes) && (ahora_dia < dia))\r\n          {\r\n              edad--;\r\n          }\r\n          if (edad > 1900)\r\n          {\r\n              edad -= 1900;\r\n          }\r\n   \r\n          // calculamos los meses\r\n          var meses=0;\r\n          if(ahora_mes>mes)\r\n              meses=ahora_mes-mes;\r\n          if(ahora_mes<mes)\r\n              meses=12-(mes-ahora_mes);\r\n          if(ahora_mes==mes && dia>ahora_dia)\r\n              meses=11;\r\n   \r\n          // calculamos los dias\r\n          var dias=0;\r\n          if(ahora_dia>dia)\r\n              dias=ahora_dia-dia;\r\n          if(ahora_dia<dia)\r\n          {\r\n              var ultimoDiaMes=new Date(ahora_ano, ahora_mes, 0);\r\n              dias=ultimoDiaMes.getDate()-(dia-ahora_dia);\r\n          }\r\n          //console.log(edad)\r\n          this.datos.birthDay2=edad\r\n          console.log(this.birthDay)\r\n        }\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState([\"userData\", \"staffData\", \"user\",\"specialServices\",\"modalServices\"])\r\n  }\r\n};\r\n",{"version":3,"sources":["editUser.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AAMA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"editUser.vue","sourceRoot":"src/components/managementuser","sourcesContent":["<template>\r\n  <v-row class=\"justify-center\">\r\n   <v-col xs=\"12\" sm=\"12\" md=\"4\" lg=\"5\" xl=\"5\" >\r\n    <v-row>\r\n     <overlayalert/>\r\n  </v-row>\r\n      <v-card>\r\n         <v-card-title class=\"justify-center\">\r\n            <v-icon left color=\"primary\">mdi-tooltip-account</v-icon>\r\n            <div class=\"title primary--text\">\r\n               Datos Personales\r\n            </div>\r\n         </v-card-title>\r\n         <v-divider></v-divider>\r\n       \r\n         \r\n         <!-- AVATAR PICTURE -->\r\n         <div class=\"text-center\">\r\n            <v-avatar v-if='datos.image===null'\r\n               size=\"100\"\r\n               class=\"mt-7 mb-7\"\r\n               >\r\n               <img  :src=\"require('@/assets/default-avatar.jpg')\" alt=\"avatar\">\r\n            </v-avatar>\r\n            <v-avatar v-if='datos.image!==null'\r\n               size=\"100\"\r\n               class=\"mt-7 mb-7\"\r\n               >\r\n               <img  :src=\"datos.image\" alt=\"avatar\">\r\n            </v-avatar>\r\n            <v-file-input\r\n               :rules=\"userDataFields.rulesUpLoadAvatar\"\r\n               color=\"secondary\"\r\n               accept=\"image/png, image/jpeg, image/bmp\"\r\n               placeholder=\"Actualizar imagen\"\r\n               prepend-icon=\"mdi-camera\"\r\n               label=\"Avatar\"\r\n               class=\"avatar-custom\"\r\n               v-model=\"datos.image2\"\r\n               ></v-file-input>\r\n         </div>\r\n              <!-- AVATAR PICTURE END-->\r\n           <v-card-text>\r\n                 <!-- ===== EXPANSION PANEL USER ===== -->\r\n         <v-expansion-panels  accordion>\r\n            <!-- FIRST NAME -->\r\n            <v-expansion-panel>\r\n               <v-expansion-panel-header >\r\n                  <div class=\"panel-title\">\r\n                     <span  class=\"primary--text font-weight-medium \">Nombres:</span><span> {{datos.firs_name}}</span>\r\n                  </div>\r\n                  <template v-slot:actions>\r\n                     <v-icon color=\"secondary\">mdi-square-edit-outline</v-icon>\r\n                  </template>\r\n               </v-expansion-panel-header>\r\n               <v-expansion-panel-content>\r\n                  <v-text-field \r\n                     v-model=\"datos.firs_name\" \r\n                     :label=\"userDataFields.firstNamesLabel\"\r\n                     color=\"secondary\"\r\n                     :hint=\"userDataFields.firstNameHint\" \r\n                     :persistent-hint=\"persistentHint\"\r\n                     >  </v-text-field>\r\n               </v-expansion-panel-content>\r\n            </v-expansion-panel>\r\n            <!-- FIRST NAME END -->\r\n            <!-- LAST NAME -->\r\n            <v-expansion-panel>\r\n               <v-expansion-panel-header >\r\n                  <div class=\"panel-title\">\r\n                     <span  class=\"primary--text font-weight-medium\">Apellidos:</span><span> {{datos.last_name}}</span>\r\n                  </div>\r\n                  <template v-slot:actions>\r\n                     <v-icon color=\"secondary\">mdi-square-edit-outline</v-icon>\r\n                  </template>\r\n               </v-expansion-panel-header>\r\n               <v-expansion-panel-content>\r\n                  <v-text-field \r\n                     v-model=\"datos.last_name\" \r\n                     :label=\"userDataFields.lastNamesLabel\"\r\n                     color=\"secondary\"\r\n                     :hint=\"userDataFields.lastNameHint\" \r\n                     :persistent-hint=\"persistentHint\"\r\n                     >  </v-text-field>\r\n               </v-expansion-panel-content>\r\n            </v-expansion-panel>\r\n            <!-- LAST NAME END -->\r\n            <!-- DOCUMENT ID -->\r\n            <v-expansion-panel>\r\n               <v-expansion-panel-header >\r\n                  <div class=\"panel-title\">\r\n                     <span  class=\"primary--text font-weight-medium\">Id:</span><span> {{datos.ident}}</span>\r\n                  </div>\r\n                  <template v-slot:actions>\r\n                     <v-icon color=\"secondary\">mdi-square-edit-outline</v-icon>\r\n                  </template>\r\n               </v-expansion-panel-header>\r\n               <v-expansion-panel-content>\r\n                  <v-text-field \r\n                     v-model=\"datos.ident\" \r\n                     :label=\"userDataFields.idLabel\"\r\n                     color=\"secondary\"\r\n                     :hint=\"userDataFields.idHint\" \r\n                     :persistent-hint=\"persistentHint\"\r\n                     >  </v-text-field>\r\n               </v-expansion-panel-content>\r\n            </v-expansion-panel>\r\n            <!-- DOCUMENT END -->\r\n            <!-- EMAIL -->\r\n            <v-expansion-panel>\r\n               <v-expansion-panel-header >\r\n                  <div class=\"panel-title\">\r\n                     <span  class=\"primary--text font-weight-medium\">Correo:</span><span> {{datos.user_email}}</span>\r\n                  </div>\r\n                  <template v-slot:actions>\r\n                     <v-icon color=\"secondary\">mdi-square-edit-outline</v-icon>\r\n                  </template>\r\n               </v-expansion-panel-header>\r\n               <v-expansion-panel-content>\r\n                  <v-text-field \r\n                     v-model=\"datos.user_email\" \r\n                     :label=\"userDataFields.emailLabel\"\r\n                     color=\"secondary\"\r\n                     :hint=\"userDataFields.emailHint\" \r\n                     :persistent-hint=\"persistentHint\"\r\n                     :rules=\"userDataFields.emailRules\"\r\n                     >  </v-text-field>\r\n               </v-expansion-panel-content>\r\n            </v-expansion-panel>\r\n            <!-- EMAIL END -->\r\n            <!-- PHONE -->\r\n            <v-expansion-panel>\r\n               <v-expansion-panel-header >\r\n                  <div class=\"panel-title\">\r\n                     <span  class=\"primary--text font-weight-medium\">Teléfono:</span><span> {{datos.userPhone}}</span>\r\n                  </div>\r\n                  <template v-slot:actions>\r\n                     <v-icon color=\"secondary\">mdi-square-edit-outline</v-icon>\r\n                  </template>\r\n               </v-expansion-panel-header>\r\n               <v-expansion-panel-content>\r\n                  <v-text-field \r\n                     v-model=\"datos.userPhone\" \r\n                     :label=\"userDataFields.phoneLabel\"\r\n                     color=\"secondary\"\r\n                     :hint=\"userDataFields.phoneHint\" \r\n                     :persistent-hint=\"persistentHint\"\r\n                     >  </v-text-field>\r\n               </v-expansion-panel-content>\r\n            </v-expansion-panel>\r\n            <!-- PHONE END -->\r\n            <!-- BIRTHDAY -->\r\n            <v-expansion-panel>\r\n               <v-expansion-panel-header>\r\n                  <div class=\"panel-title\">\r\n                     <span  class=\"primary--text font-weight-medium\">Edad:</span><span> {{datos.birthDay2}}</span>\r\n                  </div>\r\n                  <template v-slot:actions>\r\n                     <v-icon color=\"secondary\">mdi-square-edit-outline</v-icon>\r\n                  </template>\r\n               </v-expansion-panel-header>\r\n               <v-expansion-panel-content>\r\n                  <v-dialog\r\n                     ref=\"dialog\"\r\n                     v-model=\"modal\"\r\n                     :return-value.sync=\"birthDay\"\r\n                     persistent\r\n                     width=\"320px\"\r\n                     >\r\n                     <template v-slot:activator=\"{ on }\">\r\n                        <v-text-field\r\n                           v-model=\"birthDay\"\r\n                           prepend-icon=\"mdi-calendar-multiple\"\r\n                           :label=\"userDataFields.birthDayLabel\"\r\n                           color=\"secondary\"\r\n                           :hint=\"userDataFields.birthDayHint\" \r\n                           :persistent-hint=\"persistentHint\"\r\n                           readonly\r\n                           v-on=\"on\"\r\n                           ></v-text-field>\r\n                     </template>\r\n                     <v-date-picker \r\n                         max=\"2002-01-01\"\r\n                        v-model=\"birthDay\"\r\n                        :locale=\"locale\" \r\n                        scrollable>\r\n                        <div class=\"flex-grow-1\"></div>\r\n                        <v-btn text color=\"primary\" @click=\"modal = false\">Cancel</v-btn>\r\n                        <v-btn text color=\"primary\" @click=\"$refs.dialog.save(birthDay)\">OK</v-btn>\r\n                     </v-date-picker>\r\n                  </v-dialog>\r\n               </v-expansion-panel-content>\r\n            </v-expansion-panel>\r\n            <!-- BIRTHDAY END -->\r\n            <!-- ADDRESS -->\r\n            <v-expansion-panel>\r\n               <v-expansion-panel-header >\r\n                  <div class=\"panel-title\">\r\n                     <span  class=\"primary--text font-weight-medium\">Dirección:</span><span> {{datos.user_Address}}</span>\r\n                  </div>\r\n                  <template v-slot:actions>\r\n                     <v-icon color=\"secondary\">mdi-square-edit-outline</v-icon>\r\n                  </template>\r\n               </v-expansion-panel-header>\r\n               <v-expansion-panel-content>\r\n                  <v-text-field \r\n                     v-model=\"datos.user_Address\" \r\n                     :label=\"userDataFields.addressLabel\"\r\n                     color=\"secondary\"\r\n                     :hint=\"userDataFields.addressHint\" \r\n                     :persistent-hint=\"persistentHint\"\r\n                     >  </v-text-field>\r\n               </v-expansion-panel-content>\r\n            </v-expansion-panel>\r\n            <!-- ADDRESS END -->\r\n            <!-- ROLL -->\r\n            <v-expansion-panel>\r\n               <v-expansion-panel-header >\r\n                  <div class=\"panel-title\">\r\n                     <span  class=\"primary--text font-weight-medium\">Roll Actual:</span><span> {{datos.tipo}}</span>\r\n                  </div>\r\n                  <template v-slot:actions>\r\n                     <v-icon color=\"secondary\">mdi-square-edit-outline</v-icon>\r\n                  </template>\r\n               </v-expansion-panel-header>\r\n               <v-expansion-panel-content>\r\n                  <v-overflow-btn\r\n                     v-model=\"datos.tipo\" \r\n                     class=\"my-2\"\r\n                     :items=\"userDataFields.rollEdit\"\r\n                     color=\"secondary\"\r\n                     label=\"Nuevo Roll\"\r\n                     editable\r\n                     item-value=\"text\"\r\n                     :hint=\"userDataFields.rollHint\" \r\n                     :persistent-hint=\"persistentHint\"\r\n                     ></v-overflow-btn>\r\n               </v-expansion-panel-content>\r\n            </v-expansion-panel>\r\n            <!-- ROLL END -->\r\n         </v-expansion-panels>\r\n         <!-- ===== EXPANSION PANEL USER END ===== -->\r\n\r\n\r\n                </v-card-text>\r\n      \r\n    \r\n        <v-card-actions>\r\n            <v-btn color=\"primary mb-2\" v-on:click=\"actualizar()\">Actualizar información</v-btn>\r\n         </v-card-actions>\r\n       </v-card>\r\n     </v-col>\r\n         <!-- continue btn -->\r\n         <v-col xs=\"12\" sm=\"12\" md=\"4\" lg=\"4\" xl=\"4\" v-if=\"datos.tipo=='Auxiliar'\">\r\n          <br/>\r\n          <v-card>\r\n         <!-- continue btn END -->\r\n         <v-card-title class=\"justify-center\">\r\n            <v-icon left color=\"primary\">mdi-hail</v-icon>\r\n            <div class=\"title primary--text\">\r\n               Competencias del {{staffData[listNumber].userRoll}}\r\n            </div>\r\n         </v-card-title>\r\n         <v-divider></v-divider>\r\n         <!-- ===== EXPANSION PANEL USER ===== -->\r\n         <v-expansion-panels accordion>\r\n            <!-- SPECIALS SERVICES -->\r\n            <v-expansion-panel>\r\n               <v-expansion-panel-header >\r\n                  <div class=\"panel-title\">\r\n                      <v-icon left color=\"primary\">mdi-broom</v-icon>\r\n                     <span  class=\"primary--text font-weight-medium \">Servicios especiales</span>\r\n                  </div>\r\n                  <template v-slot:actions>\r\n                     <v-icon color=\"secondary\">mdi-square-edit-outline</v-icon>\r\n                  </template>\r\n               </v-expansion-panel-header>\r\n               <v-expansion-panel-content>\r\n                  <v-checkbox v-for=\"specialservice of specialServices\" :key=\"specialservice.taskid\"  v-model=\"userInternalSkills\" :label=\"specialservice.skill\" :value=\"specialservice.skill\" :disabled=\"specialservice.edit\"></v-checkbox>\r\n               </v-expansion-panel-content>\r\n               \r\n            </v-expansion-panel>\r\n            <!-- SPECIALS SERVICES END -->\r\n              <!-- SPECIALS SERVICES -->\r\n            <v-expansion-panel>\r\n               <v-expansion-panel-header >\r\n                  <div class=\"panel-title\">\r\n                      <v-icon left color=\"primary\">mdi-account-check</v-icon>\r\n                     <span  class=\"primary--text font-weight-medium \">Aplicar modalidad</span>\r\n                  </div>\r\n                  <template v-slot:actions>\r\n                     <v-icon color=\"secondary\">mdi-square-edit-outline</v-icon>\r\n                  </template>\r\n               </v-expansion-panel-header>\r\n               <v-expansion-panel-content>\r\n                  <v-checkbox v-for=\"modservice of modalServices\" :key=\"modservice.taskid\"  v-model=\"modCheckService\" :label=\"modservice.servicename\"\r\n                  :value=\"modservice.servicename\" true-value :disabled=\"modservice.edit\"\r\n                  ></v-checkbox>\r\n               </v-expansion-panel-content>\r\n               \r\n            </v-expansion-panel>\r\n            <!-- SPECIALS SERVICES END -->\r\n            \r\n            \r\n          \r\n\r\n         </v-expansion-panels>\r\n         <v-card-actions>\r\n            <v-btn color=\"primary mb-2\" v-on:click=\"actualizar(userInternalSkills,modCheckService)\">Actualizar información</v-btn>\r\n         </v-card-actions>\r\n         <!-- ===== EXPANSION PANEL USER END ===== -->\r\n                <!-- continue btn -->\r\n         \r\n         <!-- continue btn END -->\r\n      </v-card>\r\n\r\n         \r\n \r\n\r\n\r\n   </v-col>\r\n </v-row>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</template>\r\n<style>\r\n.avatar-custom {\r\n  margin: auto;\r\n  width: 190px;\r\n}\r\n</style>\r\n<script>\r\nimport overlayalert from '@/components/popups/CompPopsAlert.vue'\r\nimport { mapState,mapMutations } from \"vuex\";\r\nimport axios from 'axios'\r\nexport default {\r\n  components: {\r\n    overlayalert,\r\n  },\r\n  data() {\r\n    return {\r\n      datos: {\r\n        id: \"\",\r\n        firs_name: \"\",\r\n        last_name: \"\",\r\n        user_email: \"\",\r\n        tipo: \"\",\r\n        image: \"\",\r\n        image2: null,\r\n        ident: \"\",\r\n        userPhone: \"\",\r\n        user_Address: \"\",\r\n        birthDay: \"\",\r\n        tipo2:\"\",\r\n        userInternalSkills: [],\r\n      }, \r\n      userInternalSkills: [],\r\n      birthDay:\"\",\r\n      modCheckService:[],\r\n      listNumber: 1,\r\n      menu: false,\r\n      modal: false,\r\n      menu2: false,\r\n      locale: \"es\",\r\n      popout: false,\r\n      inset: false,\r\n      multiple: false,\r\n      disabled: false,\r\n      readonly: false,\r\n      focusable: false,\r\n      persistentHint: true,\r\n      userDataFields: {\r\n        firstNamesLabel: \"Nombres\",\r\n        firstNameHint: \"Edite sus nombres\",\r\n        lastNamesLabel: \"Apellidos\",\r\n        lastNameHint: \"Edite sus apellidos\",\r\n        idLabel: \"Documento de identidad\",\r\n        idHint: \"Edite su id\",\r\n        emailLabel: \"Email\",\r\n        emailHint: \"Edite su email\",\r\n        phoneLabel: \"Teléfono\",\r\n        phoneHint: \"Edite su teléfono\",\r\n        birthDayLabel: \"Fecha de cumpleaños\",\r\n        birthDayHint: \"Edite su cumpleaños\",\r\n        emailRules: [\r\n          v => !!v || \"Correo es requerido\",\r\n          v => /.+@.+/.test(v) || \"Correo no válido\"\r\n        ],\r\n        rulesUpLoadAvatar: [\r\n          value => !value || value.size < 2000000 || \"Máximo 2 MB!\"\r\n        ],\r\n        addressLabel: \"Dirección\",\r\n        addressHint: \"Edite la dirección\",\r\n        rollLabel: \"Su rol es:\",\r\n        rollsHint: \"Cambiar de Rol\",\r\n        rollEdit: [{ text: \"Admin\" }, { text: \"Auxiliar\" }, { text: \"Cliente\" }]\r\n      }\r\n    };\r\n  },\r\n  created: function(){\r\n    if(sessionStorage.getItem('search')){\r\n      var ident = sessionStorage.getItem('search')\r\n      sessionStorage.removeItem('search')\r\n      const path = 'http://3.15.13.45:8000/api/v1.0/users/?ident='+ident\r\n              axios.get(path).then((response)=> {\r\n                response = response.data\r\n                if (response.results[0]==null) {\r\n                  console.log(\"vacio\")\r\n                  this.popup({tipo:7,overlay:true})\r\n                  setTimeout(this.update_component, 2000)\r\n                }\r\n                else{\r\n                response = response.results[0]\r\n                var skill2=response['this_skills']\r\n                for (var skill in skill2){\r\n                  console.log(skill2[skill].skill)\r\n                  if (skill2[skill].skill==\"Cuidado de menores\"){\r\n                    this.userInternalSkills.push(\"Cuidado de menores\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Cuidado de adulto mayor\"){\r\n                    this.userInternalSkills.push(\"Cuidado de adulto mayor\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Atencion a mascotas\"){\r\n                    this.userInternalSkills.push(\"Atencion a mascotas\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Limpieza zonas comunes\"){\r\n                    this.userInternalSkills.push(\"Limpieza zonas comunes\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Diligencias y compras\"){\r\n                    this.userInternalSkills.push(\"Diligencias y compras\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Servicio de cafeteria\"){\r\n                    this.userInternalSkills.push(\"Servicio de cafeteria\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Preparacion de alimentos\"){\r\n                    this.userInternalSkills.push(\"Preparacion de alimentos\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                }\r\n                var mod2=response['this_mod']\r\n                for (var mod in mod2){\r\n                  console.log(mod2[mod].mod)\r\n                  if (mod2[mod].modalidad==\"Hogar\"){\r\n                    this.modCheckService.push(\"Hogar\")\r\n                    console.log(this.modCheckService)\r\n                  }\r\n                  if (mod2[mod].modalidad==\"Pymes\"){\r\n                    this.modCheckService.push(\"Pymes\")\r\n                    console.log(this.modCheckService)\r\n                  }\r\n                }\r\n\r\n\r\n\r\n\r\n\r\n                //response['this_skills'].forEach(guardar);\r\n                //function guardar(element, index, array){\r\n                  \r\n\r\n\r\n                console.log(\"hola\")\r\n                this.datos.id = response['id']\r\n                this.datos.firs_name = response['firs_name']\r\n                this.datos.last_name = response['last_name']\r\n                this.datos.user_email = response['user_email']\r\n                this.datos.image = response['image']\r\n                if (response['tipo']==1) {\r\n                  this.datos.tipo = \"Cliente\"\r\n                  this.datos.tipo2 = 1\r\n                }\r\n                if (response['tipo']==2) {\r\n                  this.datos.tipo = \"Auxiliar\"\r\n                  this.datos.tipo2 = 2\r\n\r\n                }\r\n                if (response['tipo']==3) {\r\n                  this.datos.tipo = \"Administrador\"\r\n                  this.datos.tipo2 = 3\r\n                }\r\n                this.datos.ident = response['ident']\r\n                this.datos.userPhone = response['userPhone']\r\n                this.datos.user_Address = response['user_Address']\r\n                this.birthDay = response['birthDay']\r\n                }\r\n              })\r\n              .catch((error) => {\r\n                this.popup({tipo:4,overlay:true})\r\n                console.log(error)\r\n              })\r\n\r\n    }\r\n    else\r\n      {var id = sessionStorage.getItem('id_edit')\r\n            console.log(id)\r\n            const path = 'http://3.15.13.45:8000/api/v1.0/users/'+id+'/'\r\n              axios.get(path).then((response)=> {\r\n                response = response.data\r\n                var skill2=response['this_skills']\r\n                for (var skill in skill2){\r\n                  console.log(skill2[skill].skill)\r\n                  if (skill2[skill].skill==\"Cuidado de menores\"){\r\n                    this.userInternalSkills.push(\"Cuidado de menores\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Cuidado de adulto mayor\"){\r\n                    this.userInternalSkills.push(\"Cuidado de adulto mayor\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Atencion a mascotas\"){\r\n                    this.userInternalSkills.push(\"Atencion a mascotas\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Limpieza zonas comunes\"){\r\n                    this.userInternalSkills.push(\"Limpieza zonas comunes\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Diligencias y compras\"){\r\n                    this.userInternalSkills.push(\"Diligencias y compras\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Servicio de cafeteria\"){\r\n                    this.userInternalSkills.push(\"Servicio de cafeteria\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                  if (skill2[skill].skill==\"Preparacion de alimentos\"){\r\n                    this.userInternalSkills.push(\"Preparacion de alimentos\")\r\n                    console.log(this.userInternalSkills)\r\n                  }\r\n                }\r\n\r\n                var mod2=response['this_mod']\r\n                for (var mod in mod2){\r\n                  console.log(mod2[mod].mod)\r\n                  if (mod2[mod].modalidad==\"Hogar\"){\r\n                    this.modCheckService.push(\"Hogar\")\r\n                    console.log(this.modCheckService)\r\n                  }\r\n                  if (mod2[mod].modalidad==\"Pymes\"){\r\n                    this.modCheckService.push(\"Pymes\")\r\n                    console.log(this.modCheckService)\r\n                  }\r\n                }\r\n\r\n\r\n\r\n\r\n                this.datos.id = response['id']\r\n                this.datos.firs_name = response['firs_name']\r\n                this.datos.last_name = response['last_name']\r\n                this.datos.user_email = response['user_email']\r\n                this.datos.image = response['image']\r\n                if (response['tipo']==1) {\r\n                  this.datos.tipo = \"Cliente\"\r\n                  this.datos.tipo2 = 1\r\n                }\r\n                if (response['tipo']==2) {\r\n                  this.datos.tipo = \"Auxiliar\"\r\n                  this.datos.tipo2 = 2\r\n                }\r\n                if (response['tipo']==3) {\r\n                  this.datos.tipo = \"Administrador\"\r\n                  this.datos.tipo2 = 3\r\n                }\r\n                this.datos.ident = response['ident']\r\n                this.datos.userPhone = response['userPhone']\r\n                this.datos.user_Address = response['user_Address']\r\n                this.birthDay = response['birthDay']\r\n              })\r\n              .catch((error) => {\r\n                this.popup({tipo:4,overlay:true})\r\n                console.log(error)\r\n              })}\r\n  },\r\n  methods:{\r\n    update_component(){\r\n      this.UpdateComponent('usermanagement')\r\n    },\r\n    actualizar(skills, mod){\r\n      var id = this.datos.id\r\n      const path = 'http://3.15.13.45:8000/api/v1.0/users/'+id+'/'\r\n      const path2 = 'http://3.15.13.45:8000/api/v1.0/skills/?id_user='+id\r\n      const path3 = 'http://3.15.13.45:8000/api/v1.0/tipo_mod/?id_user='+id\r\n        /*const path2 = 'http://localhost:8000/api/v1.0/auxi/'*/\r\n        if (this.datos.tipo == \"Cliente\") {\r\n          this.datos.tipo2 = 1\r\n        }\r\n        if (this.datos.tipo == \"Auxiliar\") {\r\n          this.datos.tipo2 = 2\r\n        }\r\n        if (this.datos.tipo == \"Admin\") {\r\n          this.datos.tipo2 = 3\r\n        }\r\n        const formData = new FormData();\r\n        formData.append('firs_name',this.datos.firs_name)\r\n        formData.append('last_name',this.datos.last_name)\r\n        formData.append('user_email',this.datos.user_email)\r\n        formData.append('tipo',this.datos.tipo2)\r\n         if (this.datos.image2==null) {\r\n\r\n        }\r\n        else{\r\n          formData.append('image',this.datos.image2)\r\n        }\r\n        if (this.datos.ident==undefined) {\r\n\r\n        }\r\n        else{\r\n          formData.append('ident',this.datos.ident)\r\n        }\r\n        formData.append('userPhone',this.datos.userPhone)\r\n        if (this.birthDay==null || this.birthDay==undefined || this.birthDay=='undefined') {\r\n\r\n        }\r\n        else{\r\n          formData.append('birthDay',this.birthDay)\r\n        }\r\n        formData.append('user_Address',this.datos.user_Address)\r\n        formData.append('tipo',this.datos.tipo2)\r\n        let options = {\r\n          headers: {\r\n            'content-type': 'multipart/form-data'\r\n          }\r\n        }\r\n      axios.delete(path2).then((response)=> {\r\n        axios.delete(path3).then((response)=> {\r\n\r\n      for (var skill in skills){\r\n        const formData = new FormData();\r\n        var id_user = this.datos.id\r\n        formData.append('id_user',id_user)\r\n        formData.append('skill',skills[skill])\r\n        var path = 'http://3.15.13.45:8000/api/v1.0/skills/'\r\n        let options = {\r\n          headers: {\r\n            'content-type': 'multipart/form-data'\r\n          }\r\n        }\r\n        axios.post(path, formData, options).then((response)=> {\r\n        })\r\n        .catch((error) => {\r\n          console.log(error)\r\n        })\r\n      }\r\n\r\n      for (var modalidad in mod){\r\n        const formData = new FormData();\r\n        var id_user = this.datos.id\r\n        formData.append('id_user',id_user)\r\n        formData.append('modalidad',mod[modalidad])\r\n        var path = 'http://3.15.13.45:8000/api/v1.0/tipo_mod/'\r\n        let options = {\r\n          headers: {\r\n            'content-type': 'multipart/form-data'\r\n          }\r\n        }\r\n        axios.post(path, formData, options).then((response)=> {\r\n        })\r\n        .catch((error) => {\r\n          console.log(error)\r\n        })\r\n      }\r\n\r\n      /*skills.forEach(guardar)\r\n      mod.forEach(guardar_mod)\r\n      function guardar(elemento,indice){\r\n        const formData = new FormData();\r\n        var id_user = response.data.id\r\n        formData.append('id_user',id_user)\r\n        formData.append('skill',elemento)\r\n        var path = 'http://3.15.13.45:8000/api/v1.0/skills/'\r\n        let options = {\r\n          headers: {\r\n            'content-type': 'multipart/form-data'\r\n          }\r\n        }\r\n        axios.post(path, formData, options).then((response)=> {\r\n        })\r\n        .catch((error) => {\r\n          console.log(error)\r\n        })\r\n      }\r\n      function guardar_mod(elemento,indice){\r\n        const formData = new FormData();\r\n        var id_user = response.data.id\r\n        formData.append('id_user',id_user)\r\n        formData.append('modalidad',elemento)\r\n        var path = 'http://3.15.13.45:8000/api/v1.0/tipo_mod/'\r\n        let options = {\r\n          headers: {\r\n            'content-type': 'multipart/form-data'\r\n          }\r\n        }\r\n        axios.post(path, formData, options).then((response)=> {\r\n        })\r\n        .catch((error) => {\r\n          console.log(error)\r\n        })\r\n      }*/\r\n\r\n\r\n      })\r\n      .catch((error) => {\r\n        console.log(error)\r\n      })\r\n      })\r\n      .catch((error) => {\r\n        console.log(error)  \r\n      })\r\n      axios.patch(path, formData, options).then((response)=> {\r\n        var info = response.data\r\n        this.datos.image = info['image']\r\n        this.popup({tipo:3,overlay:true})\r\n        setTimeout(this.paso, 2000)\r\n      })\r\n      .catch((error) => {\r\n        this.popup({tipo:4,overlay:true})\r\n        console.log(error)\r\n      })\r\n    },\r\n    paso(){\r\n      this.UpdateComponent('usermanagement')\r\n    },\r\n    ...mapMutations([\"UpdateComponent\",\"popup\"])\r\n  },\r\n  watch: { \r\n      birthDay(val) {\r\n      var fecha=val;\r\n      if (fecha==null) {\r\n\r\n      }else{\r\n\r\n      //console.log(fecha)\r\n          // Si la fecha es correcta, calculamos la edad\r\n          var values=fecha.split(\"-\");\r\n          var dia = values[2];\r\n          var mes = values[1];\r\n          var ano = values[0];\r\n          // cogemos los valores actuales\r\n          var fecha_hoy = new Date();\r\n          var ahora_ano = fecha_hoy.getYear();\r\n          var ahora_mes = fecha_hoy.getMonth()+1;\r\n          var ahora_dia = fecha_hoy.getDate();\r\n   \r\n          // realizamos el calculo\r\n          var edad = (ahora_ano + 1900) - ano;\r\n          if ( ahora_mes < mes )\r\n          {\r\n              edad--;\r\n          }\r\n          if ((mes == ahora_mes) && (ahora_dia < dia))\r\n          {\r\n              edad--;\r\n          }\r\n          if (edad > 1900)\r\n          {\r\n              edad -= 1900;\r\n          }\r\n   \r\n          // calculamos los meses\r\n          var meses=0;\r\n          if(ahora_mes>mes)\r\n              meses=ahora_mes-mes;\r\n          if(ahora_mes<mes)\r\n              meses=12-(mes-ahora_mes);\r\n          if(ahora_mes==mes && dia>ahora_dia)\r\n              meses=11;\r\n   \r\n          // calculamos los dias\r\n          var dias=0;\r\n          if(ahora_dia>dia)\r\n              dias=ahora_dia-dia;\r\n          if(ahora_dia<dia)\r\n          {\r\n              var ultimoDiaMes=new Date(ahora_ano, ahora_mes, 0);\r\n              dias=ultimoDiaMes.getDate()-(dia-ahora_dia);\r\n          }\r\n          //console.log(edad)\r\n          this.datos.birthDay2=edad\r\n          console.log(this.birthDay)\r\n        }\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState([\"userData\", \"staffData\", \"user\",\"specialServices\",\"modalServices\"])\r\n  }\r\n};\r\n</script>"]}]}